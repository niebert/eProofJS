<html><body><form><center><textarea id='input'  rows='10' cols='100'>//--------------------------------------------------------------
//------READ STUDENTANSWER - SPLIT IMATH INPUT------------------
//--------------------------------------------------------------
// (1a) $Precondition, $Conclusion ... are not encoded, map $SelectedPrecondition to $Justification
// (1b) $imathPRECONDITION, $imathCONCLUSION  ... contain the predefined encoded Steps
// (1c) default input will be defined by $Precondition, $Conclusion
// (2a) Overwrite default input by read StudentAnswer  
// (2b) Overwrite $imathPRECONDITION, $imathCONCLUSION,... by vInput
// (3a) Create all SOURCE Steps for rendering
// (3b) Export encoded solution if available
// (4)  Parse the Score and Store
//--------------------------------------------------------------
//$vTypeArr = array("DISPLAYOPTION","STEPCOUNT","STUDENTANSWER","PRECONDITION","CONCLUSION","JUSTIFICATION","PROOFSTEP","SOLUTION","ENCRYPTED","SETTINGS","SCORE")
//$aSeparator = "__#S#__";
//$aNewLine = "__#NL#__";  
//$aComma = "__#CO#__";  
//--------------------------------------------------------------
$defID    = array($PreconditionID,$ConclusionID,$JustificationID,$ProofStepID)
$defSTEP  = array($Precondition,$Conclusion,$Justification,$ProofStep)
//--------------------------------------------------------------
//----READ Input from Form-------------------
$vInputForm = getstuans($stuanswers,$thisq,0)
//-------------------------------------------
if ($vInputForm) {
  //--- Input exists ----
  $ErrorHTML .= "Use vInputForm"
  //$ErrorHTML .= str_replace($aNewLine,"<BR>",$vInputForm)
  if ($vInputForm != "") {
    //--- Input exists and is not empty ------
    //----------------------------------------
    //---SPLIT FORMAT imathFORM---------------
    //----------------------------------------
    //--Format--("DISPLAYOPTION","STEPCOUNT","STUDENTANSWER","PRECONDITION","CONCLUSION","JUSTIFICATION","PROOFSTEP","SOLUTION","ENCRYPTED","SETTINGS","SCORE");
    $imathFORM  = listtoarray($vInputForm)
    //$ErrorHTML .= " STEPCOUNT=".$imathFORM[1] 
    $ErrorHTML .= "<HR>(1) STUDENTANSWER=".str_replace($aNewLine,"<BR>",$imathFORM[2]) 
    //----------------------------------------
    //---SPLIT LINES  imathFORM---------------
    //----------------------------------------
    $min_k = 2
    $max_k = 9
    for ($k=$min_k..$max_k) {
      $imathFORM[$k] = str_replace($aNewLine,"\n",$imathFORM[$k])
    }
    $ErrorHTML .= "<HR>(2) STUDENTANSWER=".str_replace($aNewLine,"<BR>",$imathFORM[2]) 
    //---SETTINGS---
    //$k = arrayfindindex("SETTINGS",$vTypeArr) 
    //$imathFORM[$k] = str_replace($aNewLine,"\n",$imathFORM[$k])
    // END: For Loop imathFORM
  }
  // END IF:
}
// END IF:
//-------Set imathFORM Variables---------------------------
//$vTypeArr = array("DISPLAYOPTION","STEPCOUNT","STUDENTANSWER","PRECONDITION","CONCLUSION","JUSTIFICATION","PROOFSTEP","SOLUTION","ENCRYPTED","SETTINGS","SCORE")
$ta = 0
$imathDISPLAYOPTION = $imathFORM[$ta]
$ta++
$imathSTEPCOUNT = $imathFORM[$ta]
$ta++
$imathSTUDENTANSWER = $imathFORM[$ta]
$ta++
$imathPRECONDITION = $imathFORM[$ta]
$ta++
$imathCONCLUSION = $imathFORM[$ta]
$ta++
$imathJUSTIFICATION = $imathFORM[$ta]
$ta++
$imathPROOFSTEP = $imathFORM[$ta]
$ta++
$imathSOLUTION = $imathFORM[$ta]
$ta++
$imathENCRYPTED = "TEST" //$imathFORM[$ta]
$ta++
$imathSETTINGS = $imathFORM[$ta]
$ta++
$imathSCORE = $imathFORM[$ta]
$ta++
//----------------------------------------------------------


</textarea></center></form></body></html>
